import { addTodo } from '../helpers/db'
import { useState } from 'react'
import { UserAuth } from '../context/AuthContext'

export const AddNew = () => {
    const [todoText, setTodoText] = useState('')
    const { user } = UserAuth()

    const handleTextChange = (event: any) => {
        setTodoText(event.target.value)
    }

    const handleNewTodo = (e: any) => {
        if(e.key && e.key !== 'Enter') return
        addTodo(user, todoText)
        setTodoText('')
    }
    
    return (
        <div className="flex justify-between h-16 gap-6 text-gray-200">
            <input className="h-full bg-gray-800 flex-grow pl-2 rounded-xl" type="text" placeholder="New task" value={todoText} onInput={handleTextChange} onKeyDown={handleNewTodo}></input>
            <button className="h-full aspect-square bg-red-500 rounded-xl" onClick={handleNewTodo}>
                <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20.2672 45.5057L20.7043 44.8963H20.7043L20.2672 45.5057ZM18.5137 43.7748L17.9097 44.2193L18.5137 43.7748ZM42.2662 45.5057L41.8291 44.8963L42.2662 45.5057ZM44.0196 43.7748L43.4156 43.3302L44.0196 43.7748ZM18.5137 22.0582L17.9097 21.6136H17.9097L18.5137 22.0582ZM20.2672 20.3272L20.7043 20.9367L20.2672 20.3272ZM28.1052 19.5941C28.5194 19.5892 28.8512 19.2495 28.8463 18.8353C28.8414 18.4211 28.5016 18.0893 28.0874 18.0942L28.1052 19.5941ZM46.2719 36.0552C46.2769 35.6411 45.9452 35.3012 45.531 35.2962C45.1169 35.2912 44.777 35.6228 44.772 36.037L46.2719 36.0552ZM32.531 39.1828L32.4492 38.4372L32.531 39.1828ZM26.0003 38.7173L25.4734 39.251H25.4734L26.0003 38.7173ZM25.5288 32.2705L26.2741 32.3544L25.5288 32.2705ZM27.3472 28.5357L26.8203 28.0019L27.3472 28.5357ZM25.9451 30.1692L25.2708 29.8409L25.9451 30.1692ZM36.3143 37.3877L36.8412 37.9215L36.3143 37.3877ZM34.6595 38.7718L34.981 39.4494L34.6595 38.7718ZM31.2667 46.25C28.2782 46.25 26.0963 46.249 24.399 46.0675C22.7152 45.8874 21.5973 45.5367 20.7043 44.8963L19.8301 46.1152C21.0206 46.969 22.4304 47.3655 24.2395 47.559C26.035 47.751 28.3112 47.75 31.2667 47.75V46.25ZM16.25 32.9165C16.25 35.8334 16.2489 38.0821 16.4437 39.8566C16.64 41.6456 17.0428 43.0414 17.9097 44.2193L19.1178 43.3302C18.471 42.4514 18.1168 41.3519 17.9347 39.6929C17.7511 38.0193 17.75 35.8672 17.75 32.9165H16.25ZM20.7043 44.8963C20.0951 44.4593 19.5598 43.9308 19.1178 43.3302L17.9097 44.2193C18.4454 44.9472 19.0935 45.5869 19.8301 46.1152L20.7043 44.8963ZM31.2667 47.75C34.2222 47.75 36.4983 47.751 38.2939 47.559C40.103 47.3655 41.5128 46.969 42.7033 46.1152L41.8291 44.8963C40.9361 45.5367 39.8182 45.8874 38.1344 46.0675C36.4371 46.249 34.2552 46.25 31.2667 46.25V47.75ZM43.4156 43.3302C42.9736 43.9308 42.4382 44.4593 41.8291 44.8963L42.7033 46.1152C43.4398 45.5869 44.088 44.9472 44.6237 44.2193L43.4156 43.3302ZM17.75 32.9165C17.75 29.9657 17.7511 27.8136 17.9347 26.14C18.1168 24.481 18.471 23.3815 19.1178 22.5027L17.9097 21.6136C17.0428 22.7915 16.64 24.1873 16.4437 25.9764C16.2489 27.7508 16.25 29.9995 16.25 32.9165H17.75ZM19.8301 19.7177C19.0935 20.246 18.4454 20.8857 17.9097 21.6136L19.1178 22.5027C19.5598 21.9021 20.0951 21.3736 20.7043 20.9367L19.8301 19.7177ZM28.0874 18.0942C24.2194 18.14 21.7259 18.358 19.8301 19.7177L20.7043 20.9367C22.158 19.894 24.1625 19.6408 28.1052 19.5941L28.0874 18.0942ZM44.772 36.037C44.7247 39.9292 44.4681 41.9001 43.4156 43.3302L44.6237 44.2193C46.0048 42.3428 46.2255 39.8736 46.2719 36.0552L44.772 36.037ZM44.3027 28.448L35.7874 36.854L36.8412 37.9215L45.3565 29.5155L44.3027 28.448ZM27.874 29.0694L36.3894 20.6634L35.3356 19.5959L26.8203 28.0019L27.874 29.0694ZM32.4492 38.4372C30.6085 38.6391 29.3081 38.78 28.3303 38.7488C27.3714 38.7182 26.8722 38.5241 26.5272 38.1835L25.4734 39.251C26.206 39.9741 27.1543 40.2121 28.2825 40.248C29.3918 40.2834 30.818 40.1252 32.6127 39.9283L32.4492 38.4372ZM24.7835 32.1866C24.5842 33.9574 24.4235 35.3677 24.4594 36.4653C24.496 37.5843 24.7389 38.526 25.4734 39.251L26.5272 38.1835C26.1843 37.845 25.9894 37.3576 25.9586 36.4163C25.9271 35.4536 26.0694 34.1724 26.2741 32.3544L24.7835 32.1866ZM26.8203 28.0019C26.0783 28.7344 25.5738 29.2185 25.2708 29.8409L26.6194 30.4975C26.7842 30.1592 27.0585 29.8745 27.874 29.0694L26.8203 28.0019ZM26.2741 32.3544C26.4015 31.2226 26.4551 30.8351 26.6194 30.4975L25.2708 29.8409C24.9673 30.4642 24.8993 31.1572 24.7835 32.1866L26.2741 32.3544ZM35.7874 36.854C34.9727 37.6583 34.6833 37.9304 34.338 38.0942L34.981 39.4494C35.609 39.1514 36.0984 38.6547 36.8412 37.9215L35.7874 36.854ZM32.6127 39.9283C33.6569 39.8138 34.3538 39.747 34.981 39.4494L34.338 38.0942C33.9919 38.2584 33.5942 38.3116 32.4492 38.4372L32.6127 39.9283ZM44.3027 20.6634C45.3747 21.7216 46.1237 22.4632 46.614 23.0976C47.0913 23.7151 47.25 24.1404 47.25 24.5557H48.75C48.75 23.6746 48.3804 22.9301 47.8008 22.1803C47.2344 21.4474 46.3982 20.6242 45.3565 19.5959L44.3027 20.6634ZM45.3565 29.5155C46.3982 28.4872 47.2344 27.664 47.8008 26.9311C48.3804 26.1813 48.75 25.4368 48.75 24.5557H47.25C47.25 24.971 47.0913 25.3963 46.614 26.0138C46.1237 26.6482 45.3747 27.3898 44.3027 28.448L45.3565 29.5155ZM45.3565 19.5959C44.3148 18.5675 43.481 17.7423 42.7389 17.1833C41.9791 16.6111 41.2296 16.25 40.346 16.25V17.75C40.7757 17.75 41.2112 17.9105 41.8365 18.3815C42.4795 18.8658 43.2309 19.6054 44.3027 20.6634L45.3565 19.5959ZM36.3894 20.6634C37.4612 19.6054 38.2126 18.8658 38.8556 18.3815C39.4809 17.9105 39.9164 17.75 40.346 17.75V16.25C39.4625 16.25 38.713 16.6111 37.9532 17.1833C37.2111 17.7423 36.3773 18.5675 35.3356 19.5959L36.3894 20.6634ZM45.3565 28.448L36.3894 19.5959L35.3356 20.6634L44.3027 29.5155L45.3565 28.448Z" fill="rgb(229 231 235)"/>
                </svg>  
            </button>
        </div>
    )
}